FROM node:18-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./

# Clear npm cache and install dependencies
RUN npm cache clean --force
RUN npm set registry https://registry.npmjs.org/
RUN npm install --no-optional
# RUN npm install

# Verify React installation
RUN npm list react || echo "React not found, installing..."
RUN npm install react@^18.2.0 react-dom@^18.2.0 @types/react@^18.2.15 @types/react-dom@^18.2.7

# Copy source code
COPY . .

# Expose port
EXPOSE 3000

# Start development server with npm run dev
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--port", "3000"]